---
title: A Staræœç´¢ç®—æ³•åŸç†åŠå…¶ç¨‹åºå®ç°
date: 2024-07-16 17:24:00
tags: ç®—æ³•
---

## è¿è¡Œç¯å¢ƒæ¨è

1. anaconda3ï¼Œé›†æˆäº†å¸¸ç”¨çš„ç”¨äºç§‘å­¦è®¡ç®—çš„åŒ…ï¼Œä»¥åŠå¯¹åº”çš„Pythonè§£é‡Šå™¨(æœ¬ä¾‹ä½¿ç”¨çš„è§£é‡Šå™¨ç‰ˆæœ¬ä¸º3.9.12)
2. ç¼–è¾‘å™¨ï¼šVScode

## æ‘˜è¦

æœ¬æ–‡å°†ä»¥è¿·å®«æ¢ç´¢æœ€ä¼˜è·¯å¾„ä¸ºä¾‹ï¼Œè®²è§£A *æœç´¢ç®—æ³•åŸç†åŠå…¶ç¨‹åºå®ç°ã€‚

åœ¨åŸç†è®²è§£éƒ¨åˆ†ï¼Œé¦–å…ˆä»ä¸ºä»€ä¹ˆè¦ä½¿ç”¨A *æœç´¢ç®—æ³•å’ŒA *æœç´¢ç®—æ³•çš„å…¨å±€æœ€ä¼˜é€»è¾‘å‡ºå‘ï¼Œè®²è§£A *ç®—æ³•çš„åŸç†ã€‚å…¶æ¬¡å¯¹A *çš„è¡ŒåŠ¨å‡½æ•°g(n)å’Œå¯å‘å‡½æ•°h(n)çš„ç»†èŠ‚è¿›è¡Œäº†è®²è§£è¯´æ˜ï¼Œå¹¶è¡¥å……äº†å¯å‘å‡½æ•°çš„é€‰æ‹©å¯¹äºA *ç®—æ³•çš„å½±å“ã€‚

åœ¨ç¨‹åºå®ç°éƒ¨åˆ†ï¼Œé¦–å…ˆä»ç¨‹åºæµç¨‹æ¡†å›¾å‡ºå‘ï¼Œè§£é‡ŠA *ç®—æ³•çš„æµç¨‹ã€‚å…¶æ¬¡æŒ‰å‡½æ•°çš„ç±»åˆ’åˆ†å¹¶è®²è§£ä¸»è¦ä»£ç ï¼Œæ¥ç€å±•ç¤ºç¨‹åºçš„è¿è¡Œç»“æœï¼Œæœ€åå¯¹A *ç®—æ³•è¿›è¡Œæ€»ç»“åˆ†æã€‚

## åŸç†è®²è§£

### ä¸ºä»€ä¹ˆè¦ä½¿ç”¨A*æœç´¢ç®—æ³•ï¼Ÿ

æœç´¢ç®—æ³•çš„æ ¸å¿ƒæ˜¯ä»èµ·ç‚¹å‡ºå‘ï¼Œæ‰¾åˆ°ä¸€æ¡åˆ°è¾¾ç›®æ ‡çš„æœ€ä¼˜ï¼ˆè·¯å¾„æœ€çŸ­/æˆæœ¬æœ€ä½/ä¸¤è€…å…¼å…·ï¼‰çš„è·¯å¾„ã€‚

æ ¹æ®ä¸åŒéœ€æ±‚ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé€‰æ‹©ï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ã€Dijkstraç®—æ³•ï¼ˆç»Ÿä¸€æˆæœ¬æœç´¢ï¼‰å’Œè´ªå©ªä¼˜å…ˆæœç´¢ä¹‹ä¸€ï¼Œä¸‹é¢æˆ‘ä»¬é€ä¸ªåˆ†æå…¶ä¼˜åŠ£ã€‚

1. å¹¿åº¦ä¼˜å…ˆç®—æ³•ï¼šä¸è€ƒè™‘æ¯ä¸€æ­¥çš„ç§»åŠ¨æˆæœ¬ï¼Œä¸æ–­æ‹“å±•è¾¹ç•Œï¼Œç›´åˆ°è¾¹ç•Œåˆ°è¾¾ç›®æ ‡ç‚¹ï¼Œé€šå¸¸è€—è´¹å¤§é‡æ—¶é—´ã€‚

2. Dijkstraç®—æ³•ï¼šä»¥BFSä¸ºåŸºç¡€ï¼Œ**åªè€ƒè™‘æ¯ä¸€ç‚¹çš„æ€»ç§»åŠ¨æˆæœ¬**ï¼Œæ²¡æœ‰è§£å†³BFSè€—è´¹å¤§é‡æ—¶é—´çš„é—®é¢˜ã€‚

3. è´ªå©ªä¼˜å…ˆæœç´¢ï¼š**åªè€ƒè™‘åˆ°è¾¾ç»ˆç‚¹çš„ä¼°è®¡è·ç¦»**ï¼Œèƒ½è¾ƒå¿«å¯»æ‰¾åˆ°ç›®æ ‡ï¼Œä½†æ˜¯æ— æ³•ä¿è¯è·¯çº¿å…¨å±€æœ€ä¼˜ã€‚

4. A*æœç´¢ç®—æ³•ï¼šä»¥BSFä¸ºåŸºç¡€ï¼Œ**ç»¼åˆè€ƒè™‘äº†æ€»ç§»åŠ¨æˆæœ¬å’Œåˆ°è¾¾ç»ˆç‚¹çš„ä¼°è®¡è·ç¦»**ï¼Œå·§å¦™åœ°å åŠ äº†Dijkstraç®—æ³•çš„æˆæœ¬æœ€ä½å’Œè´ªå©ªä¼˜å…ˆæœç´¢çš„é€Ÿåº¦æœ€ä¼˜ï¼Œå…·æœ‰æ›´å¥½çš„æ€§èƒ½ã€‚

5. ä¸‹é¢æ˜¯A * ç®—æ³•çš„æ ¸å¿ƒå…¬å¼ï¼š
   
   ![image-20240726004205520](https://cdn.jsdelivr.net/gh/kashima19960/img@master/%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C%E7%9A%84%E6%B1%82%E8%A7%A3%E6%96%B9%E6%B3%95/image-20240726004205520.png)


> ###### è¯´æ˜ï¼šf(n)æ˜¯æ€»çš„é¢„æœŸæˆæœ¬ï¼Œg(n)æ˜¯å½“å‰ç‚¹åˆ°èµ·ç‚¹çš„æ€»ç§»åŠ¨æˆæœ¬ï¼Œh(n)æ˜¯å½“å‰ç‚¹åˆ°ç›®æ ‡ç‚¹çš„é¢„æœŸä»£ä»·



### A *æœç´¢ç®—æ³•çš„å…¨å±€æœ€ä¼˜é€»è¾‘

é¦–å…ˆï¼Œå¯¹äºæœç´¢ç®—æ³•æ¥è¯´ï¼Œæƒ³è¦å‡å°‘æœç´¢çš„æ—¶é—´ï¼Œé‚£å°±å¿…é¡»è¦åœ¨æœç´¢æœ€ä¼˜è·¯å¾„æ—¶æœç´¢å°½é‡å°‘çš„ç‚¹ï¼Œæœ€å¥½æœç´¢çš„å…¨éƒ¨èŠ‚ç‚¹æ°å¥½å°±æ˜¯æˆ‘ä»¬çš„å…¨å±€æœ€ä¼˜è·¯å¾„ã€‚ä½†æ˜¾ç„¶ï¼Œåƒè´ªå©ªä¼˜å…ˆæœç´¢é‚£æ ·ï¼Œåªè€ƒè™‘å½“å‰ç‚¹åˆ°ç›®æ ‡ç‚¹çš„é¢„æœŸè·ç¦»çš„è¯ï¼Œå¾€å¾€åªèƒ½å¯»æ‰¾åˆ°å±€éƒ¨æœ€ä¼˜ã€‚

![è´ªå¿ƒçš„å±€éƒ¨æœ€ä¼˜](https://raw.githubusercontent.com/kashima19960/img/master/A_Star/%E8%B4%AA%E5%BF%83%E7%9A%84%E5%B1%80%E9%83%A8%E6%9C%80%E4%BC%98.png)

**æ¢å¥è¯è¯´ï¼Œè´ªå©ªä¼˜å…ˆç®—æ³•åªè€ƒè™‘å•ä¸€çš„ï¼šå½“å‰ç‚¹åˆ°ç›®æ ‡ç‚¹çš„ä¼°è®¡è·ç¦»ï¼Œè¿™æ˜¾ç„¶ä¸è¶³ä»¥ä½œä¸ºå…¨å±€æœ€ä¼˜çš„å‚è€ƒæŒ‡æ ‡ã€‚ä½†æ˜¯å®ƒèµ‹äºˆäº†ç¨‹åºæœ‰ç›®çš„åœ°å‰å¾€ç»ˆç‚¹æ–¹å‘çš„èƒ½åŠ›**



è€Œæˆ‘ä»¬çŸ¥é“ï¼ŒBFSã€Dijkstraå®è´¨ä¸Šæ˜¯å¯¹æ‰€æœ‰èŠ‚ç‚¹è¿›è¡Œéå†ï¼Œå…¶ä¸­åè€…æ˜¯å¯¹å‰è€…çš„ä¼˜åŒ–ï¼Œä¿è¯äº†èµ·ç‚¹åˆ°æ¯ä¸€ä¸ªä¸­é—´ç‚¹éƒ½æ˜¯æˆæœ¬æœ€ä¼˜çš„é€‰æ‹©ã€‚

![Dijkstraä¿éšœå½“å‰ç‚¹å¯¹äºèµ·ç‚¹æœ€ä¼˜](https://raw.githubusercontent.com/kashima19960/img/master/A_Star/Dijkstra%E4%BF%9D%E9%9A%9C%E5%BD%93%E5%89%8D%E7%82%B9%E5%AF%B9%E4%BA%8E%E8%B5%B7%E7%82%B9%E6%9C%80%E4%BC%98.png)

é‚£æˆ‘ä»¬ç»“åˆä¸€ä¸‹Dijkstraï¼ˆä¿éšœå½“å‰ç‚¹å¯¹èµ·ç‚¹æ˜¯**æˆæœ¬**æœ€ä¼˜çš„ï¼‰å’Œè´ªå©ªä¼˜å…ˆæœç´¢ï¼ˆä¿éšœå½“å‰ç‚¹åˆ°ç»ˆç‚¹çš„**æ–¹å‘**æ˜¯æœ€ä¼˜çš„ï¼‰

å°±å¯ä»¥æ„å»ºä¸€ä¸ªæ–°çš„å‚è€ƒæŒ‡æ ‡ï¼šç”¨äºä¿è¯æ¯ä¸€æ¬¡ä»å½“å‰ç‚¹é€‰æ‹©ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™éƒ½æ˜¯å…¨å±€æœ€ä¼˜çš„ã€‚

![å…¨å±€æœ€ä¼˜ç†è§£](https://raw.githubusercontent.com/kashima19960/img/master/A_Star/%E5%85%A8%E5%B1%80%E6%9C%80%E4%BC%98%E7%90%86%E8%A7%A3.png)



### å¯¹è¡ŒåŠ¨å‡½æ•°  **g(n)**   çš„ç»†èŠ‚è¯´æ˜ï¼ˆ**å¯ä»¥ç®€å•ç†è§£gæ˜¯å°å…µ**ï¼‰

åœ¨A *ç®—æ³•ä¸­å¯¹äºg(n)ï¼Œä¹Ÿå°±æ˜¯ä»èµ·ç‚¹åˆ°å½“å‰ç‚¹çš„æ€»ç§»åŠ¨ä»£ä»·ï¼ˆæ²‰æ²¡æˆæœ¬ï¼‰ï¼Œå¦‚æœæˆ‘ä»¬åªè€ƒè™‘ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘çš„è¯ï¼Œå¹¶ä¸éœ€è¦é¢å¤–è€ƒè™‘æ¯ä¸€æ­¥è¡ŒåŠ¨çš„ä»£ä»·ï¼ˆå› ä¸ºæ¯ä¸€æ­¥éƒ½æ˜¯ç›¸åŒçš„ï¼‰ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä»ä¸Šä¸‹å·¦å³å’Œå››ä¸ªè¾¹è§’éƒ½èƒ½è¢«è¡ŒåŠ¨ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦è€ƒè™‘èµ°æ–œè¾¹å’Œç›´ä¸Šç›´ä¸‹çš„ä»£ä»·å·®å¼‚ã€‚

æœ¬æ ·ä¾‹ä¸­ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½æ˜¯æ­£æ–¹å½¢ï¼Œä»è€Œå¯çŸ¥èµ°æ–œè¾¹ä¸ç›´ä¸Šç›´ä¸‹çš„ä»£ä»·æ¯”å€¼åº”ä¸º

![image-20240726004310005](https://cdn.jsdelivr.net/gh/kashima19960/img@master/%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C%E7%9A%84%E6%B1%82%E8%A7%A3%E6%96%B9%E6%B3%95/image-20240726004310005.png)

æˆ‘ä»¬ä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼Œå–1.4ï¼š1ä½œä¸ºèµ°æ–œè¾¹å’Œç›´ä¸Šç›´ä¸‹çš„ä»£ä»·æ¯”å€¼



### å¯¹å¯å‘å‡½æ•°  **h(n)**   çš„è®²è§£ï¼ˆ**å¯ä»¥ç®€å•ç†è§£hæ˜¯é¢†å¯¼**ï¼‰

åœ¨A *ç®—æ³•ä¸­å¯¹äºh(n)ï¼Œä¹Ÿå°±æ˜¯å¯¹å½“å‰ç‚¹åˆ°ç›®æ ‡ç‚¹çš„é¢„æœŸä»£ä»·ä¼°è®¡é€šå¸¸é‡‡ç”¨â€œè·ç¦»â€ä½œä¸ºåº¦é‡ã€‚

åœ¨äºŒç»´åœ°å›¾ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºä¸¤ç‚¹é—´è·ç¦»å¸¸ç”¨çš„æ–¹å¼æœ‰ä¸¤ç§ã€‚

1. æ›¼å“ˆé¡¿è·ç¦»

   

   ![æ›¼å“ˆé¡¿è·ç¦»V2](https://raw.githubusercontent.com/kashima19960/img/master/A_Star/%E6%9B%BC%E5%93%88%E9%A1%BF%E8%B7%9D%E7%A6%BBV2.png)

   ![image-20240726004329674](https://cdn.jsdelivr.net/gh/kashima19960/img@master/%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C%E7%9A%84%E6%B1%82%E8%A7%A3%E6%96%B9%E6%B3%95/image-20240726004329674.png)
   
   æ›¼å“ˆé¡¿è·ç¦»ç”¨æ¥æ ‡æ˜ä¸¤ä¸ªç‚¹åœ¨æ ‡å‡†åæ ‡ç³»ä¸Šçš„ç»å¯¹è½´è·æ€»å’Œï¼Œç®€å•æ¥ç†è§£å°±æ˜¯ï¼šç›´è§’ä¸‰è§’å½¢çš„ä¸¤ç›´è§’è¾¹ä¹‹å’Œ
   
   

2. æ¬§å¼è·ç¦»

   

   ![æ¬§å¼è·ç¦»](https://raw.githubusercontent.com/kashima19960/img/master/A_Star/%E6%AC%A7%E6%B0%8F%E8%B7%9D%E7%A6%BB.png)

   ![image-20240726004347846](./assets/image-20240726004347846.png)
   
   æ¬§å¼è·ç¦»ç”¨æ¥æ ‡æ˜ä¸¤ä¸ªç‚¹åœ¨æ ‡å‡†åæ ‡ç³»ä¸Šçš„ç»å¯¹è·ç¦»ï¼Œç®€å•æ¥ç†è§£å°±æ˜¯ï¼šç›´è§’ä¸‰è§’å½¢çš„æ–œè¾¹



åœ¨æ¥ä¸‹æ¥çš„ä»£ç å®ç°ä¸­ï¼Œå› ä¸ºæ›¼å“ˆé¡¿è·ç¦»ä¸éœ€è¦å¼€æ–¹ï¼Œè®¡ç®—è¾ƒä¸ºç®€ä¾¿ï¼Œå› æ­¤æœ¬ä¾‹é€‰ç”¨æ›¼å“ˆé¡¿è·ç¦»ä½œä¸ºå¯å‘å‡½æ•°çš„å‚è€ƒæŒ‡æ ‡ã€‚



### è¡¥å……ï¼šå¯å‘å‡½æ•°çš„é€‰æ‹©å¯¹ç®—æ³•çš„å½±å“ï¼ˆäº†è§£ï¼‰

![image-20240726004416685](https://cdn.jsdelivr.net/gh/kashima19960/img@master/%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C%E7%9A%84%E6%B1%82%E8%A7%A3%E6%96%B9%E6%B3%95/image-20240726004416685.png)

| æƒ…å†µ          | ç®—æ³•                 | ç»“æœ                               |
| ------------- | -------------------- | ---------------------------------- |
| h(n)=0        | A*é€€åŒ–ä¸ºDijkstraç®—æ³• | ä¿è¯èƒ½æ‰¾åˆ°æœ€çŸ­è·¯å¾„ï¼Œä½†æ—¶é—´èŠ±è´¹è¾ƒå¤§ |
| h(n)=å®é™…ä»£ä»· | ä»…æ‹“å±•å¿…è¦èŠ‚ç‚¹       | æ—¶é—´å’Œè·¯å¾„éƒ½æœ€ä½³                   |
| h(n)>>g(n)    | A*ç®—æ³•é€€åŒ–åˆ°è´ªå©ªä¼˜å…ˆ | ä¸ä¿è¯å…¨å±€è·¯å¾„æœ€ä¼˜ï¼Œä½†é€Ÿåº¦å¾ˆå¿«     |



## ç¨‹åºæµç¨‹å›¾

![A-starç®—æ³•æµç¨‹](https://raw.githubusercontent.com/kashima19960/img/master/A_Star/A-star%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B.png)

- åœ°å›¾åˆå§‹åŒ–ï¼šè®¾ç½®åœ°å›¾å¤§å°ã€èµ·ç‚¹ç»ˆç‚¹ã€éšœç¢ç‰©ã€‚
- éå†å¾…æµ‹èŠ‚ç‚¹ï¼šå°†èµ·ç‚¹æ”¾å…¥å¾…æµ‹åˆ—è¡¨ï¼ˆopen_listï¼‰ä¸­ï¼Œè¿›è€Œè®©A *ç®—æ³•å¼€å§‹è¿è¡Œï¼Œè®¡ç®—å¹¶å­˜å‚¨åˆ—è¡¨ä¸­æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„ "f(n) " ã€‚
- å®šä½æ­£åœ¨æ£€æµ‹ç‚¹ï¼šæŸ¥æ‰¾"f(n) "æœ€å°çš„èŠ‚ç‚¹ï¼Œå¹¶æŠŠå®ƒå®šä½ä¸ºæ­£åœ¨æ£€æµ‹çš„ç‚¹ï¼ˆselect_currentï¼‰ã€‚
- é‚»ç‚¹æ£€æµ‹ï¼šA *ç®—æ³•çš„æ ¸å¿ƒï¼Œé€šè¿‡å¯¹é‚»ç‚¹å±æ€§çš„åˆ¤æ–­å’Œå¯¹é¢„æœŸæ€»ç§»åŠ¨æˆæœ¬çš„æƒè¡¡æ¥é€‰æ‹©ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
- ç§»åŠ¨åˆ°å·²æµ‹ç‚¹é›†ï¼šå°†å·²ç»æ£€æµ‹è¿‡ä½†æ˜¯æ²¡è¢«é€‰æ‹©çš„èŠ‚ç‚¹æ”¾å…¥å·²æµ‹åˆ—è¡¨ä¸­ï¼Œä¿è¯ä¸ä¼šé‡å¤æœç´¢
- æ‰¾åˆ°ç»ˆç‚¹ï¼šæ‰¾åˆ°ç»ˆç‚¹åï¼Œç”±ç»ˆç‚¹å‘èµ·ç‚¹è¿›è¡Œæœ€çŸ­è·¯å¾„çš„å›æº¯ï¼Œå¹¶é€šè¿‡è°ƒç”¨pillowåº“ï¼Œå°†ç»“æœå¯¼å‡ºä¸ºå›¾ç‰‡

## AStarç±»

æ˜¯æ•´ä¸ªç®—æ³•çš„å…³é”®ï¼Œå†…éƒ¨åŒ…æ‹¬äº†A *ç®—æ³•çš„åˆå§‹åŒ–ã€æœ€ä¼˜ç‚¹é€‰æ‹©ã€é‚»ç‚¹æ£€æµ‹ã€èŠ‚ç‚¹åˆ¤æ–­å’Œè·¯å¾„å¯»æ‰¾åŠŸèƒ½çš„å®ç°

### åˆå§‹åŒ–å‚æ•°

é€šè¿‡æ„é€ å‡½æ•°ï¼Œå°†åœ°å›¾å±æ€§ï¼šåœ°å›¾å¤§å°ã€èµ·ç‚¹ã€ç»ˆç‚¹å’Œéšœç¢ç‰©è¯»å…¥ï¼Œåˆå§‹åŒ– A *ç®—æ³•çš„å‚æ•°ï¼š

```python
    def __init__(self, start: Point, end: Point, map2d: Map2D):
        self.path = []			
        self.closed_list = []
        self.open_list = []
        self.start = start
        self.end = end
        self.map2d = map2d
```



### æœ€ä¼˜ç‚¹é€‰æ‹©

éå†å¾…æ£€æµ‹é˜Ÿåˆ—ï¼ˆopen_listï¼‰ï¼Œæ‰¾åˆ°få€¼æœ€å°çš„èŠ‚ç‚¹ï¼ˆå…¨å±€æœ€ä¼˜èŠ‚ç‚¹ï¼‰ï¼Œç„¶åè¿”å›å…¨å±€æœ€ä¼˜èŠ‚ç‚¹

```python
    def select_current(self):
        min_f = sys.maxsize
        node_temp = None
        for node in self.open_list:
            if node.f < min_f:
                min_f = node.f
                node_temp = node
        return node_temp
```



### åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦åœ¨å¾…æ£€æµ‹é˜Ÿåˆ—ä¸­

é€šè¿‡è¯»å…¥è¦åˆ¤æ–­çš„èŠ‚ç‚¹ï¼ˆnodeï¼‰ï¼Œéå†open_listï¼Œåˆ¤æ–­nodeæ˜¯å¦åœ¨å¾…æµ‹é˜Ÿåˆ—ä¸­

```python
    def is_in_open_list(self, node):
        return any([open_node.point == node.point for open_node in self.open_list])
```



### åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦åœ¨å·²æ£€æµ‹é˜Ÿåˆ—ä¸­

é€šè¿‡è¯»å…¥è¦åˆ¤æ–­çš„èŠ‚ç‚¹ï¼ˆnodeï¼‰ï¼Œéå†closed_listï¼Œåˆ¤æ–­nodeæ˜¯å¦åœ¨å·²æ£€æµ‹é˜Ÿåˆ—ä¸­

```python
    def is_in_closed_list(self, node):
        return any([closed_node.point == node.point for closed_node in self.closed_list])
```



### åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦æ˜¯éšœç¢ç‰©

é€šè¿‡è¯»å…¥è¦åˆ¤æ–­çš„èŠ‚ç‚¹ï¼ˆnodeï¼‰ï¼Œç®€å•æ¯”è¾ƒèŠ‚ç‚¹æ˜¯å¦ä¸º"â¬›"ï¼Œè¿›è€Œåˆ¤æ–­nodeæ˜¯å¦æ˜¯éšœç¢ç‰©

```python
    def is_obstacle(self, node):
        return self.map2d.data[node.point.x][node.point.y] == "â¬›"
```



### ç›¸é‚»ç‚¹æ£€æµ‹

é€šè¿‡å¯¹å½“å‰èŠ‚ç‚¹ï¼ˆnodeï¼‰çš„"ä¸Šä¸‹å·¦å³"å’Œ"å››è§’"çš„å…«ä¸ªæ–¹å‘è¿›è¡Œæ£€æµ‹ï¼Œå¯»æ‰¾å…¨å±€æœ€ä¼˜çš„ç‚¹ï¼Œåˆ¤æ–­ä¸‹ä¸€æ­¥è¯¥å‰å¾€å“ªä¸ªèŠ‚ç‚¹ï¼Œå…¶ä¸­åŒ…æ‹¬å¯¹é‚»ç‚¹æ˜¯å¦ä¸ºç»ˆç‚¹ã€å·²æ£€æµ‹ç‚¹ã€å¾…æ£€æµ‹ç‚¹ã€æœ€ä¼˜èŠ‚ç‚¹æˆ–éšœç¢ç‰©çš„ä¸€ç³»åˆ—åˆ¤æ–­

```python
    def explore_neighbors(self, node):
        # å®šä¹‰å…«ä¸ªæ–¹å‘
        directions = [(1, 0), (-1, 0), (0, 1), (0, -1), (1, 1), (1, -1), (-1, 1), (-1, -1)]
        for direction in directions:
            ud, rl = direction
            # æ ¹æ®æ–¹å‘è®¡ç®—ç›¸é‚»èŠ‚ç‚¹
            neighbor = node.get_near(ud, rl)
            # å¦‚æœç›¸é‚»èŠ‚ç‚¹æ˜¯ç»ˆç‚¹ï¼Œåˆ™è¿”å› True
            if neighbor.point == self.end:
                return True
            # å¦‚æœç›¸é‚»èŠ‚ç‚¹åœ¨ closed_list ä¸­æˆ–ä¸ºéšœç¢ç‰©ï¼Œåˆ™è·³è¿‡
            if self.is_in_closed_list(neighbor) or self.is_obstacle(neighbor):
                continue
            # å¦‚æœç›¸é‚»èŠ‚ç‚¹åœ¨ open_list ä¸­ï¼Œåˆ™æ¯”è¾ƒè¯„åˆ†
            if self.is_in_open_list(neighbor):
                existing_node = next(open_node for open_node in self.open_list if open_node.point == neighbor.point)
                if neighbor.f < existing_node.f:
                    # å¦‚æœè¯„åˆ†æ›´ä¼˜ï¼Œåˆ™æ›´æ–°ç›¸é‚»èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å’Œè¯„åˆ†
                    existing_node.father = node
                    existing_node.g = neighbor.g
            else:
                # å¦‚æœç›¸é‚»èŠ‚ç‚¹ä¸åœ¨ open_list ä¸­ï¼Œåˆ™å°†å…¶åŠ å…¥ open_list
                neighbor.father = node
                self.open_list.append(neighbor)
        return False
```



### å¯»æ‰¾è·¯å¾„

è¿™ä¸ªæ–¹æ³•å°†èµ·ç‚¹å¦å¤–å­˜å‚¨åœ¨å›æº¯è·¯å¾„åˆ—è¡¨é‡Œï¼ˆpathï¼‰ï¼Œå¹¶ä¸æ–­é€‰æ‹©æœ€ä¼˜èŠ‚ç‚¹å‰è¿›ï¼ŒåŒæ—¶æ¯ä¸€æ¬¡å‰è¿›åˆ°ä¸‹ä¸€ä¸ªæœ€ä¼˜èŠ‚ç‚¹æ—¶ï¼Œéƒ½ä¼šå°†æœ€ä¼˜èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ”¾è¿›å›æº¯è·¯å¾„ï¼ˆpathï¼‰ä¸­ï¼Œåœ¨æœ€åæ‰¾åˆ°ç»ˆç‚¹åï¼Œåˆ©ç”¨å›æº¯è·¯å¾„åˆ—è¡¨ä»ç»ˆç‚¹å›æº¯åˆ°èµ·ç‚¹ï¼ˆå­èŠ‚ç‚¹æŒ‰çˆ¶èŠ‚ç‚¹å›æº¯ï¼‰

```python
    def find_path(self):
        # åˆ›å»ºèµ·ç‚¹èŠ‚ç‚¹
        start_node = AStar.Node(self.start, self.end, 0)
        self.open_list.append(start_node)

        while True:
            # é€‰æ‹©å½“å‰æœ€ä¼˜èŠ‚ç‚¹
            current_node = self.select_current()
            # å¦‚æœæ²¡æœ‰æœ€ä¼˜èŠ‚ç‚¹ï¼Œåˆ™è¿”å› None
            if current_node is None:
                return None
            # å°†å½“å‰èŠ‚ç‚¹ä» open_list ä¸­ç§»é™¤ï¼Œå¹¶åŠ å…¥ closed_list ä¸­
            self.open_list.remove(current_node)
            self.closed_list.append(current_node)

            # å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯ç»ˆç‚¹ï¼Œåˆ™è¿”å›è·¯å¾„
            if current_node.point == self.end:
                # æ²¿ç€çˆ¶èŠ‚ç‚¹å›æº¯è·¯å¾„
                while current_node.father is not None:
                    self.path.insert(0, current_node.point)
                    current_node = current_node.father
                return self.path

            # æ¢ç´¢ç›¸é‚»èŠ‚ç‚¹
            if self.explore_neighbors(current_node):
                # å¦‚æœæ‰¾åˆ°äº†ç»ˆç‚¹ï¼Œåˆ™æ²¿ç€çˆ¶èŠ‚ç‚¹å›æº¯è·¯å¾„
                while current_node.father is not None:
                    self.path.insert(0, current_node.point)
                    current_node = current_node.father
                return self.path
```



## AStar.Nodeç±»

æ˜¯AStarç±»çš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼ŒåŒ…å«çš„åˆå§‹åŒ–ä¸­é—´èŠ‚ç‚¹å‚æ•°å’Œè·å–ç›¸é‚»èŠ‚ç‚¹çš„æ–¹æ³•æ˜¯é‚»ç‚¹æ£€æµ‹å’Œå¯»æ‰¾è·¯å¾„çš„åŸºç¡€

### åˆå§‹åŒ–ä¸­é—´èŠ‚ç‚¹çš„å‚æ•°

æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–èŠ‚ç‚¹çš„å‚æ•°ï¼špoint:ï¼ˆå½“å‰èŠ‚ç‚¹çš„åæ ‡ï¼‰ã€endpointï¼ˆç»ˆç‚¹çš„åæ ‡ï¼‰ã€gï¼ˆä»èµ·ç‚¹åˆ°å½“å‰èŠ‚ç‚¹çš„ä»£ä»·ï¼‰ï¼Œå¹¶ä¸”é€šè¿‡æ›¼å“ˆé¡¿è·ç¦»è®¡ç®—è¿™æ¡è·¯å¾„é¢„è®¡çš„æ€»ç§»åŠ¨æˆæœ¬ï¼Œæ˜¯æœ€ä¼˜ç‚¹é€‰æ‹©çš„åŸºç¡€

```python
        def __init__(self, point: Point, endpoint: Point, g: float):
            self.point = point
            self.endpoint = endpoint
            self.father = None
            self.g = g
            # è®¡ç®—å¯å‘å€¼hï¼Œä½¿ç”¨æ›¼å“ˆé¡¿è·ç¦»
            self.h = (abs(endpoint.x - point.x) + abs(endpoint.y - point.y)) * 10
            # è®¡ç®—é¢„è®¡çš„æ€»ç§»åŠ¨æˆæœ¬f
            self.f = self.g + self.h
```

### è·å–ç›¸é‚»èŠ‚ç‚¹

è·å–ä¸Šä¸‹å·¦å³å’Œå››è§’å…±å…«ä¸ªæ–¹å‘çš„é‚»ç‚¹ï¼Œè®¡ç®—å¹¶æ›´æ–°A *ç®—æ³•çš„g(n)å€¼ï¼Œæ˜¯é‚»ç‚¹æ£€æµ‹çš„åŸºç¡€

ud: ä¸Šä¸‹æ–¹å‘çš„ç§»åŠ¨é‡ï¼ˆ1 è¡¨ç¤ºå‘ä¸Šï¼Œ-1 è¡¨ç¤ºå‘ä¸‹ï¼Œ0 è¡¨ç¤ºä¸ç§»åŠ¨ï¼‰

rl: å·¦å³æ–¹å‘çš„ç§»åŠ¨é‡ï¼ˆ1 è¡¨ç¤ºå‘å³ï¼Œ-1 è¡¨ç¤ºå‘å·¦ï¼Œ0 è¡¨ç¤ºä¸ç§»åŠ¨ï¼‰

```python
        def get_near(self, ud, rl):
            # æ ¹æ®ä¸Šä¸‹å·¦å³å’Œå››è§’ï¼Œå…±å…«ä¸ªæ–¹å‘ï¼Œè®¡ç®—ç›¸é‚»èŠ‚ç‚¹çš„åæ ‡
            near_point = Point(self.point.x + rl, self.point.y + ud)
            # è®¡ç®—ç›¸é‚»èŠ‚ç‚¹çš„æ€»ç§»åŠ¨æˆæœ¬
            near_node = AStar.Node(near_point, self.endpoint, self.g + (10 if ud == 0 or rl == 0 else 14))
            return near_node
```



## Map2D ç±»

ä¸»è¦æ˜¯å¯¹ç”Ÿæˆçš„2Dåœ°å›¾è¿›è¡Œå¤„ç†ï¼ŒåŒ…æ‹¬åœ°å›¾åˆå§‹åŒ–å’Œå¯¼å‡ºåœ°å›¾æ•°æ®çš„åŠŸèƒ½

### åˆå§‹åŒ–åœ°å›¾

æ„é€ å‡½æ•°ï¼Œé€šè¿‡è¯»å–ç”¨æˆ·è®¾å®šçš„åœ°å›¾å¤§å°ï¼Œåˆå§‹åŒ–åœ°å›¾æ•°æ®ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ”¾ç½®ä¸€ä¸ª"â¬œ"å­—ç¬¦

```python
    def __init__(self, height, width):
        self.height = height
        self.width = width
        self.data = [["â¬œ" for _ in range(width)] for _ in range(height)]
```



### å¯¼å‡ºåœ°å›¾æ•°æ®

è°ƒç”¨pillowæ¨¡å—ï¼Œåœ¨A *ç®—æ³•æ‰€åœ¨çš„ py æ–‡ä»¶å¤¹å†…ç”Ÿæˆä¸€ä¸ª result.png çš„å›¾ç‰‡ï¼Œé¦–å…ˆå°†å…¶ç»˜åˆ¶ä¸ºå…¨ç™½è‰²èƒŒæ™¯ï¼Œå†ä¾æ¬¡éå†A *ç®—æ³•å¤„ç†åçš„åœ°å›¾æ•°æ®ï¼Œå¹¶åœ¨ç™½è‰²èƒŒæ™¯ä¸Šç»˜åˆ¶é¢œè‰²ï¼Œæœ€åå±•ç¤ºä¸€ä¸ªA *ç®—æ³•å¤„ç†åçš„ç»“æœå›¾ï¼ˆåŒ…å«æœ€ä¼˜è·¯å¾„ï¼‰

```python
    def export_image(self, file_name="map.png"):
        # è®¾ç½®å•å…ƒæ ¼å¤§å°
        cell_size = 10
        # åˆ›å»ºä¸€ä¸ªç™½è‰²èƒŒæ™¯çš„å›¾åƒ
        image = Image.new("RGB", (self.width * cell_size, self.height * cell_size), "white")
        # åˆ›å»ºä¸€ä¸ªç»˜å›¾å¯¹è±¡
        draw = ImageDraw.Draw(image)

        # éå†åœ°å›¾æ•°æ®ï¼Œæ ¹æ®ä¸åŒçš„å­—ç¬¦ç»˜åˆ¶ä¸åŒçš„é¢œè‰²
        for x in range(self.height):
            for y in range(self.width):
                color = "white"
                if self.data[x][y] == "â¬›":
                    color = "black"
                elif self.data[x][y] == "ğŸŸ¥":
                    color = "red"
                elif self.data[x][y] == "ğŸŸ©":
                    color = "green"
                # ç»˜åˆ¶ä¸€ä¸ªçŸ©å½¢
                draw.rectangle([(y * cell_size, x * cell_size), ((y + 1) * cell_size, (x + 1) * cell_size)], fill=color)

        # ä¿å­˜å›¾åƒ
        image.save(file_name)
```



### è®¾ç½®éšœç¢ç‰©

é€šè¿‡ç”¨æˆ·è®¾ç½®çš„éšœç¢ç‚¹åæ ‡ï¼Œå°†"â¬œ"ï¼ˆå¯æ¢ç´¢ä½ç½®ï¼‰æ›´æ–°ä¸º"â¬›"ï¼ˆéšœç¢ç‰©ï¼‰

```python
    def set_obstacle(self, x, y):
        self.data[x][y] = "â¬›"
```



### è®¾ç½®èµ·ç‚¹å’Œç»ˆç‚¹

é€šè¿‡ç”¨æˆ·è®¾ç½®çš„èµ·ç‚¹å’Œç»ˆç‚¹åæ ‡ï¼Œå°†"â¬œ"ï¼ˆå¯æ¢ç´¢ä½ç½®ï¼‰æ›´æ–°ä¸º"ğŸŸ¥"ï¼ˆèµ·ç‚¹æˆ–è€…ç»ˆç‚¹ï¼‰

```python
    def set_start_end(self, start: Point, end: Point):
        self.data[start.x][start.y] = "ğŸŸ¥"
        self.data[end.x][end.y] = "ğŸŸ¥"
```



## å…¶ä»–å‡½æ•°

### éšæœºæ”¾ç½®éšœç¢ç‰©

é¦–å…ˆè®¡ç®—åœ°å›¾æ€»æ ¼æ•°ï¼Œé€šè¿‡ obstacle_ratio è®¾ç½®éšœç¢ç‰©å å…¨å›¾çš„æ¯”ä¾‹ï¼Œå†é€šè¿‡å¾ªç¯æ¥å®ç°å¤§èŒƒå›´çš„éšœç¢ç‰©æ”¾ç½®ï¼ŒåŒæ—¶è®¾ç½®äº†å¯¹èµ·ç‚¹ç»ˆç‚¹å’Œç°æœ‰éšœç¢ç‰©çš„ä¿æŠ¤ï¼Œè¾¾åˆ°å¢åŠ æœç´¢éš¾åº¦çš„ç›®çš„

```python
total_cells = map2d.height * map2d.width  # è®¡ç®—åœ°å›¾æ€»æ ¼æ•°
obstacle_cells = int(total_cells * 0.3)  # è®¡ç®—éšœç¢ç‰©æ ¼æ•°ï¼Œè¿™é‡Œè®¾ç½®éšœç¢ç‰©å æ®åœ°å›¾çš„ 30%

for _ in range(obstacle_cells):
    x = random.randint(0, map2d.height - 1)
    y = random.randint(0, map2d.width - 1)
    # ç¡®ä¿éšœç¢ç‰©ä¸è¦†ç›–èµ·ç‚¹ã€ç»ˆç‚¹æˆ–å…¶ä»–éšœç¢ç‰©
    while (x == start_point.x and y == start_point.y) or (x == end_point.x and y == end_point.y) or map2d.data[x][y] == "â¬›":
        x = random.randint(0, map2d.height - 1)
        y = random.randint(0, map2d.width - 1)

    # è®¾ç½®éšœç¢ç‰©
    map2d.set_obstacle(x, y)

```



## è¿è¡Œç»“æœå±•ç¤º

![image-20240319230213276](https://raw.githubusercontent.com/kashima19960/img/master/A_Star/image-20240319230213276.png)

![50x50result](https://raw.githubusercontent.com/kashima19960/img/master/A_Star/50x50result.png)



### åœ¨100 x 100åœ°å›¾ä¸‹è¿è¡Œ

![image-20240319230328817](https://raw.githubusercontent.com/kashima19960/img/master/A_Star/image-20240319230328817.png)

<img src="https://raw.githubusercontent.com/kashima19960/img/master/A_Star/100x100result.png" alt="100x100result" style="zoom:50%;" />

### åœ¨150 x 150åœ°å›¾ä¸‹è¿è¡Œ

![image-20240319230339514](https://raw.githubusercontent.com/kashima19960/img/master/A_Star/image-20240319230339514.png)

<img src="https://raw.githubusercontent.com/kashima19960/img/master/A_Star/150x150result.png" alt="150x150result" style="zoom:50%;" />

### åœ¨200 x 200åœ°å›¾ä¸‹è¿è¡Œ

![image-20240319230349324](https://raw.githubusercontent.com/kashima19960/img/master/A_Star/image-20240319230349324.png)

<img src="https://raw.githubusercontent.com/kashima19960/img/master/A_Star/200x200result.png" alt="200x200result" style="zoom: 33%;" />

## æ€»ç»“ä¸åˆ†æ

æ€»ä½“è€Œè¨€ï¼ŒA *ç®—æ³•åœ¨éšæœºç”Ÿæˆéšœç¢ç‰©çš„æƒ…å†µä¸‹ï¼Œç”±äºå…¶ä½¿ç”¨äº†å¯å‘å‡½æ•°ï¼Œå°½å¯èƒ½åœ°å‡å°‘äº†è¿‡ç¨‹ä¸­ä¸å¿…è¦çš„æœç´¢ï¼Œæ‰€ä»¥æ— è®ºæ˜¯åœ¨50 x 50,100 x 100,150 x 150è¿˜æ˜¯200 x 200çš„æµ‹è¯•æ ·ä¾‹ä¸­å‡èƒ½åœ¨0.05så·¦å³æ‰¾åˆ°æ­£ç¡®çš„æœ€ä¼˜è·¯å¾„ï¼Œå±•ç°äº†A *ç®—æ³•çš„ä¼˜è¶Šæ€§ã€‚

## é™„å½•ï¼šå®Œæ•´ä»£ç 

```python
import sys
import time
from typing import List
import random
from PIL import Image, ImageDraw

"""
Pointç±»æ˜¯æ•°å­¦åæ ‡ç³»çš„ä¸€ä¸ªæŠ½è±¡çš„ç‚¹,å’ŒNodeç±»ä¸æ˜¯ä¸€å›äº‹
"""
class Point:
    def __init__(self, x, y)->None:
        self.x = x
        self.y = y

    #é‡è½½â€œ==â€è¿ç®—ç¬¦ï¼Œ(x1,y1)==(x2,y2)ï¼Œå½“ä¸”ä»…å½“x1=x2ï¼Œy1=y2
    def __eq__(self, other)->bool:
        return self.x == other.x and self.y == other.y

class Map2D:
    def __init__(self, height, width)->None:
        self.height = height
        self.width = width
        #widthå¯ä»¥çœ‹æˆäºŒç»´åœ°å›¾çš„è¡Œï¼Œheightå¯ä»¥çœ‹æˆäºŒç»´åœ°å›¾çš„åˆ—
        self.data = [["â¬œ" for _ in range(width)] for _ in range(height)]

    #å°†åœ°å›¾æ•°æ®ç”¨æ–‡æœ¬å¯¼å‡º
    def show(self, file_name="output.txt")->None:
        with open(file_name, 'w', encoding='utf-8') as file:
            for row in self.data:
              file.write(" ".join(row) + '\n')

    #å°†åœ°å›¾æ•°æ®ç”¨å›¾ç‰‡å¯¼å‡º
    def export_image(self, file_name="map.png")->None:
        cell_size = 10
        image = Image.new("RGB", (self.width * cell_size, self.height * cell_size), "white")
        draw = ImageDraw.Draw(image)
        for x in range(self.height):
            for y in range(self.width):
                color = "white"
                if self.data[x][y] == "â¬›":
                    color = "black"
                elif self.data[x][y] == "ğŸŸ¥":
                    color = "red"
                elif self.data[x][y] == "ğŸŸ©":
                    color = "green"
                draw.rectangle([(y * cell_size, x * cell_size), ((y + 1) * cell_size, (x + 1) * cell_size)], fill=color)
        image.save(file_name)

    #å½“åœ°å›¾ç‚¹ä¸ºâ¬›ï¼Œåˆ™ä¸ºéšœç¢ç‰©
    def set_obstacle(self, x, y):
        self.data[x][y] = "â¬›"

    #è®¾ç½®èµ·ç‚¹å’Œç»ˆç‚¹
    def set_start_end(self, start: Point, end: Point)->None:
        self.data[start.x][start.y] = "ğŸŸ¥"
        self.data[end.x][end.y] = "ğŸŸ¥"
    def obstacle_generate(self, ratio:int)->None:
        # éšæœºæ”¾ç½®éšœç¢ç‰©
        obstacle_cells = int((self.height * self.width) * ratio)  # éšœç¢ç‰©å æ®40%çš„æ ¼å­
        for _ in range(obstacle_cells):
            x = random.randint(0, map2d.height - 1)
            y = random.randint(0, map2d.width - 1)
            while (x == start_point.x and y == start_point.y) or (x == end_point.x and y == end_point.y) or map2d.data[x][y] == "â¬›":
                x = random.randint(0, map2d.height - 1)
                y = random.randint(0, map2d.width - 1)
            map2d.set_obstacle(x, y)

"""
1.udæŒ‡çš„æ˜¯up and down
2.rlæŒ‡çš„æ˜¯right and left
"""
class Node:
    def __init__(self, point: Point, endpoint: Point, g: float):# åˆå§‹åŒ–ä¸­é—´èŠ‚ç‚¹çš„å‚æ•°
        self.point = point
        self.endpoint = endpoint
        self.father = None
        self.g = g
        #hå–æ›¼å“ˆé¡¿è·ç¦»ï¼Œc=|x2-x1|+|y2-y1|
        self.h = (abs(endpoint.x - point.x) + abs(endpoint.y - point.y)) * 10
        self.f = self.g + self.h

    def get_near(self, ud, rl):#è·å–ç›¸é‚»èŠ‚ç‚¹
        near_point = Point(self.point.x + rl, self.point.y + ud)
        near_node = Node(near_point, self.endpoint, self.g + (10 if ud == 0 or rl == 0 else 14))
        return near_node
    
class AStar:
    def __init__(self, start: Point, end: Point, map2d: Map2D):#åˆå§‹åŒ–A*ç®—æ³•çš„å‚æ•°
        self.path = []
        self.closed_list = []
        self.open_list = []
        self.start = start
        self.end = end
        self.map2d = map2d

    #ä»open_listé‡Œé¢æ‰¾åˆ°ä¸€ä¸ªä»£ä»·æœ€å°çš„èŠ‚ç‚¹
    def select_current(self)->Node:
        min_f = sys.maxsize
        node_temp = None
        for node in self.open_list:
            if node.f < min_f:
                min_f = node.f
                node_temp = node
        return node_temp

    def is_in_open_list(self, node:Node)->bool:# åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦åœ¨å¾…æ£€æµ‹é˜Ÿåˆ—ä¸­
        return any([open_node.point == node.point for open_node in self.open_list])

    def is_in_closed_list(self, node:Node)->bool:# åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦åœ¨å·²æ£€æµ‹é˜Ÿåˆ—ä¸­
        return any([closed_node.point == node.point for closed_node in self.closed_list])

    def is_obstacle(self, node:Node)->bool:# åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦æ˜¯éšœç¢ç‰©
        return self.map2d.data[node.point.x][node.point.y] == "â¬›"

    """
è¿™ä¸ªå‡½æ•°æ˜¯A*ç®—æ³•çš„æ ¸å¿ƒå‡½æ•°ï¼Œæ‰¾åˆ°å½“å‰èŠ‚ç‚¹ä»£ä»·æœ€å°çš„é‚»ç‚¹
ç”¨listæ¥å½“ä½œæ˜¯é˜Ÿåˆ—çš„æ•°æ®ç»“æ„ï¼Œå­˜æ”¾æ¢æµ‹è¿‡æˆ–è€…æœªè¢«æ¢æµ‹çš„èŠ‚ç‚¹ï¼Œä»¥æ­¤æ¥è¿›è¡Œè·¯å¾„æ¢ç´¢
åœ¨è·¯å¾„æ¢ç´¢ä¸­èŠ‚ç‚¹æœ‰ä¸‰ç§çŠ¶æ€
çŠ¶æ€1.åŠ å…¥äº†é˜Ÿåˆ—å¹¶ä¸”å·²ç»æ£€æµ‹äº†ï¼Œè¿™ä¸ªå•ç‹¬ç”¨ä¸€ä¸ªClose_listé˜Ÿåˆ—å­˜æ”¾
çŠ¶æ€2.åŠ å…¥äº†é˜Ÿåˆ—ä½†æ˜¯è¿˜æ²¡æœ‰æ£€æµ‹ï¼Œè¿™ä¸ªç”¨Open_listé˜Ÿåˆ—å­˜æ”¾
çŠ¶æ€3.è¿˜æ²¡æœ‰è¢«åŠ å…¥é˜Ÿåˆ—
    """
    def explore_neighbors(self, current_node:Node)->bool:
        up=(0,1)#ä¸Š
        down=(0,-1)#ä¸‹
        right=(1,0)#å³
        left=(-1,0)#å·¦
        top_right=(1,1)#å³ä¸Š
        top_left=(-1,1)#å·¦ä¸Š
        Bottom_right=(1,-1)#å³ä¸‹
        Bottom_left=(-1,-1)#å·¦ä¸‹
        directions = [up,down,right,left,top_right,top_left,Bottom_right,Bottom_left]
        for direction in directions:
            ud, rl = direction
            #current_neighboræ˜¯å½“å‰èŠ‚ç‚¹çš„é‚»ç‚¹
            current_neighbor = current_node.get_near(ud, rl)
            #å¦‚æœæ£€æµ‹åˆ°çš„èŠ‚ç‚¹æ˜¯ç»ˆç‚¹ï¼Œå°±æ²¡å¿…è¦æ¥ç€å¾€ä¸‹æ¢ç´¢äº†ï¼Œç›´æ¥é€€å‡ºå¾ªç¯ï¼Œç»“æŸè¿™ä¸ªå‡½æ•°
            if current_neighbor.point == self.end:
                return True
            #åˆ¤æ–­ä¸€ä¸‹é‚»ç‚¹æ˜¯ä¸æ˜¯å·²ç»æ£€æµ‹æˆ–è€…æ˜¯éšœç¢ç‰©ï¼Œå¦‚æœæ˜¯ï¼Œå°±è·³è¿‡è¿™ä¸ªé‚»ç‚¹
            if self.is_in_closed_list(current_neighbor) or self.is_obstacle(current_neighbor):
                continue
            if self.is_in_open_list(current_neighbor):
                """
                ä½œç”¨:åœ¨open_listä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸current_neighborç›¸åŒ(åæ ‡ç›¸åŒ)çš„èŠ‚ç‚¹
                è¿™é‡Œæœ‰ä¸¤ä¸ªå€¼å¾—æ³¨æ„çš„ç‚¹
                1.åœ¨open_listä¸­,å¯èƒ½æœ‰å¤šä¸ªä¸current_neighborç›¸åŒ(åæ ‡ç›¸åŒ)çš„èŠ‚ç‚¹ï¼Œ
                å‡ºç°è¿™ç§æƒ…å†µæ˜¯å› ä¸ºåŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ˜¯å¯ä»¥é€šè¿‡å¤šæ¡ä¸åŒçš„è·¯å¾„æŠµè¾¾çš„(æ„æ€å°±æ˜¯gå€¼ä¸åŒ)
                æ¯”å¦‚è¯´èŠ‚ç‚¹Cæ˜¯å½“å‰èŠ‚ç‚¹,ç‚¹Aä¸èŠ‚ç‚¹Béƒ½èƒ½æŠµè¾¾èŠ‚ç‚¹Cä¸”gå€¼éƒ½ç›¸åŒ,é‚£ä¹ˆèŠ‚ç‚¹Cæ­¤æ—¶åœ¨open_listå°±ä¼šè¢«æ·»åŠ ä¸¤æ¬¡

                2.previous_current_neighboræ˜¯å–çš„åœ¨open_listä¸­ä¸current_neighborç›¸åŒ(åæ ‡ç›¸åŒ)çš„èŠ‚ç‚¹ä¸­
                ä»–ä»¬å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯gå€¼ä¸åŒä½†å› ä¸ºæœ‰å¤šä¸ªåŒ¹é…,å› æ­¤è¿™é‡Œç”¨nextå‡½æ•°åªå–ä¸€æ¬¡å³å¯
                """

                previous_current_neighbor = next(open_node for open_node in self.open_list if open_node.point == current_neighbor.point)

                """
                è¿™æ—¶å°±è¦æ¯”è¾ƒcurrent_neighborä¸previous_current_neighborçš„ä»£ä»·äº†,
                å‡å¦‚æˆ‘åœ¨æœ¬æ¬¡çš„è·¯å¾„æ¢ç´¢åˆ°çš„current_neighborè¦æ¯”æˆ‘ä¹‹å‰çš„è·¯å¾„æ¢ç´¢åˆ°çš„previous_current_neighborçš„ä»£ä»·è¦å°
                (è¿™é‡Œæ—¶åˆ»æ³¨æ„,current_neighborä¸previous_current_neighboræ˜¯åæ ‡ç›¸åŒçš„),é‚£ä¹ˆæˆ‘å°±è¦æ›´æ–°previous_current_neighborçš„ä»£ä»·
                """
                if current_neighbor.f < previous_current_neighbor.f:
                    #æ›´æ–°çˆ¶èŠ‚ç‚¹
                    previous_current_neighbor.father = current_node
                    #æ›´æ–°gå€¼
                    previous_current_neighbor.g = current_neighbor.g
            else:
                #å¯¹åº”çŠ¶æ€3ï¼Œç›´æ¥å…¥é˜Ÿ
                current_neighbor.father = current_node
                self.open_list.append(current_neighbor)
        return False

    def find_path(self):
        start_node = Node(point=self.start, endpoint=self.end, g=0)
        self.open_list.append(start_node)
        while True:
            #ä»open_listé‡Œé¢å–å‡ºä¸€ä¸ªä»£ä»·å€¼æœ€å°èŠ‚ç‚¹
            current_node = self.select_current()
            if current_node is None:
                return None
            #å–å‡ºæ¥åï¼Œä»open_listé‡Œé¢åˆ é™¤ï¼Œæ·»åŠ åˆ°closed_listé‡Œé¢
            self.open_list.remove(current_node)
            self.closed_list.append(current_node)
            #å½“current_nodeæ˜¯ç»ˆç‚¹æ—¶ï¼Œexplore_neighborså‡½æ•°ä¼šè¿”å›ä¸€ä¸ªTrue
            if current_node.point == self.end or self.explore_neighbors(current_node):
                while current_node.father is not None:
                    self.path.insert(0, current_node.point)
                    #è¿™é‡Œå…¶å®å°±æ˜¯ç›¸å½“äºéå†ä¸€ä¸ªé“¾è¡¨
                    current_node = current_node.father
                return self.path

if __name__ == "__main__":
    # åˆ›å»ºåœ°å›¾
    map2d = Map2D(20, 20)
    # è®¾ç½®èµ·ç‚¹å’Œç»ˆç‚¹
    start_point = Point(1, 3)
    end_point = Point(6, 15)
    map2d.set_start_end(start_point, end_point)
    map2d.obstacle_generate(0.1)
    # è¿è¡ŒA*ç®—æ³•
    start_time = time.time()
    a_star = AStar(start_point, end_point, map2d)
    path = a_star.find_path()
    end_time = time.time()
    # æ‰“å°ç»“æœ
    if path:
        print("æ‰¾åˆ°æœ€ä½³è·¯å¾„ï¼š")
        for point in path:
            map2d.data[point.x][point.y] = "ğŸŸ©"
    else:
        print("æœªæ‰¾åˆ°è·¯å¾„ï¼")
    map2d.export_image("result.png")
    # æ‰“å°è¿è¡Œæ—¶é—´
    print("ç¨‹åºè¿è¡Œæ—¶é—´ï¼š", end_time - start_time, "ç§’")

```







